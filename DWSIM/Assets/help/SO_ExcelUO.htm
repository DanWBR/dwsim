<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<script src="ContentScripts.js"></script>
<head>
<link rel="stylesheet" type="text/css" href="DWSIMstyle.css">
</head>

<!-- ================================================================================== -->
<!-- ====================   Begin of content    ==============================================-->
<!-- ================================================================================== -->
<body onload="LoadMenue()">

<H2>Excel Unit Operation</H2>
<a href="SO_CustomUO.htm" target="_parent"><img src="pictures/arrow-up.gif"></a>
<a href="SO_FlowsheetUO.htm" target="_parent"><img src="pictures/arrow-down.gif"></a>
<hr>

<p>The Excel unit operation is used to enable user defined models of unit operations which 
are calculated by Excel spread sheet calculator.<br><br>

Each instance of that unit operation model is associated with a separate calculation file. This file is preconfigured
in a special way to recieve data from DWSIM for executing the calculations and hold results to be transfered back.
The results are fetched from DWSIM to be fed back into the exit streams of that unit operation.<br>
You also may transfere user defined parameters from DWSIM to Excel and read other user defined parameters as results back to DWSIM.

Up to four streams may be connected both to inlet and outlet of that unit. 
The energy stream recieves the calculatd energy from enthalpy balance.</p>

<table>
<tr>
<td><img src="pictures/SO_ExcelUO1.png"></td>

<td>
This sample depicts a simple model of a membrane electrolysis cell stack with inlet streams for Anolyte and Catholyte solution.
We also have outlet streams for Anolyte and Catholyte. 

<h3>Calculation Parameters</h3>
Calculation parameters are defined inside the Excel definition file as input parameters.<br><br>
<b>ExcelUOEditor:</b> This field displays the Excel file beeing associated with that unit. Click on file name to open Unit editor.
<br>

<h3>Results</h3>
<b>Heat added</b> After calculating the Excel user model DWSIM calculates the enthalpy balance of input and output streams.<br>
Other results are parameters calculated by the user model as output parameters.

<h3>Annotation</h3>
The selected parameter may contain an anotation which is defined inside the Excel file for.
</td>

</tr>
</table>
<hr>

<table>
<tr>
<td><img src="pictures/SO_ExcelUO2.png"></td>

<td>
<h3>Search</h3>
Button to search Excel file to be associated with Unit Operation<br>

<h3>Create New</h3>
Button to create new definition file from template.

<h3>Edit</h3>
Opens definition file with Excel for editing. After editing you just save the Excel file from within Excel.
</td>

</tr>
</table>

<hr>
<h2>Excel definition file</h2>
The excel definition file has a preconfigured structure which should not be altered. 
Otherwise DWSIM may not be able to transfere information forth and back in the right way!<br>

<h3>Input Tab</h3>
DWSIM is writing informations of all connected input streams into the blue area. 
From line 12 downward all components and their molar flows are listed.

<p>The red area contains the parameters which are required for calculation. 
This parameters are displayed in DWSIM as "Calculation Parameters" inside the property tab of ExcelUO.<br>
You may list as many properties as you want here. DWSIM starts to read the list below the heading downwards
until it finds an empty cell. Each parameter features a name, a value, a unit and an annotation.</p>

<img src="pictures/SO_ExcelUO3.png">

<h3>Output Tab</h3>
The output tab has the same structure as the input tab.<br>

Molare flows of each component of every output stream are to be written into their fields by the user 
defined calculation procedures.<br>
You also have to calculate temperature and pressure of all streams leaving the unit. The enthalpy of each stream
is calculated by DWSIM automatically after finishing Ecel calculations.<br>


<h3>Results</h3>
DWSIM is calculating the enthalpy balance of the unit from enthalpy of outlet streams minus enthalpy of inlet streams. 
The result of this calculation is written to the energy stream.<br>

After finishing the calculations in Excel DWSIM checks the mass balance of that unit. If massbalance is not ok DWSIM
will issue an error message.

<br><br>
</BODY>
</HTML>